import{O as g,k as o,P as F,Q as te,R as se,S as C,T as ae,U as re,d as N,V as ne,W as le,X as oe,H as p,Y as ie,Z as ce,B as ue,b as u,c as m,r as z,g as V,t as de,f as s,L as A,F as _,$ as B,i as w,e as K,w as fe,a0 as ve,a1 as pe,a2 as me,a3 as ge,a4 as ye,a5 as j,a6 as we,a7 as he}from"./app-C5E7XBok.js";import{E as Le}from"./index-B8DctFvE.js";const Ee=(a,r)=>{if(!g||!a||!r)return!1;const t=a.getBoundingClientRect();let n;return r instanceof Element?n=r.getBoundingClientRect():n={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<n.bottom&&t.bottom>n.top&&t.right>n.left&&t.left<n.right},Se=["class","style"],be=/^on[A-Z]/,Ie=(a={})=>{const{excludeListeners:r=!1,excludeKeys:t}=a,n=o(()=>((t==null?void 0:t.value)||[]).concat(Se)),d=te();return d?o(()=>{var l;return F(Object.entries((l=d.proxy)==null?void 0:l.$attrs).filter(([f])=>!n.value.includes(f)&&!(r&&be.test(f))))}):o(()=>({}))},D=se({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:C([String,Object])},previewSrcList:{type:C(Array),default:()=>ae([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:C(String)}}),ke={load:a=>a instanceof Event,error:a=>a instanceof Event,switch:a=>re(a),close:()=>!0,show:()=>!0},Ce=N({name:"ElImage",inheritAttrs:!1}),ze=N({...Ce,props:D,emits:ke,setup(a,{emit:r}){const t=a;let n="";const{t:d}=ne(),l=le("image"),f=oe(),O=o(()=>F(Object.entries(f).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),M=Ie({excludeListeners:!0,excludeKeys:o(()=>Object.keys(O.value))}),L=p(),y=p(!1),v=p(!0),E=p(!1),h=p(),c=p(),Y=g&&"loading"in HTMLImageElement.prototype;let S,b;const U=o(()=>[l.e("inner"),I.value&&l.e("preview"),v.value&&l.is("loading")]),W=o(()=>{const{fit:e}=t;return g&&e?{objectFit:e}:{}}),I=o(()=>{const{previewSrcList:e}=t;return Array.isArray(e)&&e.length>0}),X=o(()=>{const{previewSrcList:e,initialIndex:i}=t;let x=i;return i>e.length-1&&(x=0),x}),T=o(()=>t.loading==="eager"?!1:!Y&&t.loading==="lazy"||t.lazy),k=()=>{g&&(v.value=!0,y.value=!1,L.value=t.src)};function Z(e){v.value=!1,y.value=!1,r("load",e)}function q(e){v.value=!1,y.value=!0,r("error",e)}function $(){Ee(h.value,c.value)&&(k(),R())}const H=ie($,200,!0);async function P(){var e;if(!g)return;await pe();const{scrollContainer:i}=t;me(i)?c.value=i:ge(i)&&i!==""?c.value=(e=document.querySelector(i))!=null?e:void 0:h.value&&(c.value=ye(h.value)),c.value&&(S=j(c,"scroll",H),setTimeout(()=>$(),100))}function R(){!g||!c.value||!H||(S==null||S(),c.value=void 0)}function G(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function Q(){I.value&&(b=j("wheel",G,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",E.value=!0,r("show"))}function J(){b==null||b(),document.body.style.overflow=n,E.value=!1,r("close")}function ee(e){r("switch",e)}return ce(()=>t.src,()=>{T.value?(v.value=!0,y.value=!1,R(),P()):k()}),ue(()=>{T.value?P():k()}),(e,i)=>(u(),m("div",B({ref_key:"container",ref:h},s(O),{class:[s(l).b(),e.$attrs.class]}),[y.value?z(e.$slots,"error",{key:0},()=>[V("div",{class:A(s(l).e("error"))},de(s(d)("el.image.error")),3)]):(u(),m(_,{key:1},[L.value!==void 0?(u(),m("img",B({key:0},s(M),{src:L.value,loading:e.loading,style:s(W),class:s(U),crossorigin:e.crossorigin,onClick:Q,onLoad:Z,onError:q}),null,16,["src","loading","crossorigin"])):w("v-if",!0),v.value?(u(),m("div",{key:1,class:A(s(l).e("wrapper"))},[z(e.$slots,"placeholder",{},()=>[V("div",{class:A(s(l).e("placeholder"))},null,2)])],2)):w("v-if",!0)],64)),s(I)?(u(),m(_,{key:2},[E.value?(u(),K(s(Le),{key:0,"z-index":e.zIndex,"initial-index":s(X),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:J,onSwitch:ee},{default:fe(()=>[e.$slots.viewer?(u(),m("div",{key:0},[z(e.$slots,"viewer")])):w("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):w("v-if",!0)],64)):w("v-if",!0)],16))}});var Ae=ve(ze,[["__file","image.vue"]]);const Be=we(Ae),Te=N({__name:"HairyImage",props:D,setup(a){const r=a,t=he("HairyImageGroup:preview",void 0);return(n,d)=>(u(),K(s(Be),B(r,{class:["HairyImage",[s(t)&&"cursor-pointer rounded"]],onClick:d[0]||(d[0]=l=>{var f;return(f=s(t))==null?void 0:f(n.src)})}),null,16,["class"]))}});export{Te as _};
